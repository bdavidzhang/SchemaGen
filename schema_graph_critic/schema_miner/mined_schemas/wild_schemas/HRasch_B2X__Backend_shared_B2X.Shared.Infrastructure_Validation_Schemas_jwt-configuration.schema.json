{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://B2X.com/schemas/jwt-configuration.schema.json",
  "title": "JWT Configuration Schema",
  "description": "JSON schema for validating JWT authentication configuration in B2X services",
  "type": "object",
  "properties": {
    "Jwt": {
      "type": "object",
      "description": "JWT authentication configuration settings",
      "properties": {
        "Secret": {
          "type": "string",
          "description": "Cryptographically secure secret key for JWT token signing and validation",
          "minLength": 32,
          "maxLength": 512,
          "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[^a-zA-Z\\d]).{32,}$",
          "examples": [
            "YourSuperSecureRandomStringHere123!@#"
          ]
        },
        "Issuer": {
          "type": "string",
          "description": "Identifies the principal that issued the JWT token",
          "minLength": 1,
          "maxLength": 256,
          "examples": [
            "B2X",
            "https://auth.B2X.com"
          ]
        },
        "Audience": {
          "type": "string",
          "description": "Identifies the recipients that the JWT is intended for",
          "minLength": 1,
          "maxLength": 256,
          "examples": [
            "B2X.API",
            "https://api.B2X.com"
          ]
        },
        "TokenExpirationMinutes": {
          "type": "integer",
          "description": "Access token lifetime in minutes",
          "minimum": 1,
          "maximum": 1440,
          "default": 60,
          "examples": [15, 30, 60, 120]
        },
        "RefreshTokenExpirationDays": {
          "type": "integer",
          "description": "Refresh token lifetime in days",
          "minimum": 1,
          "maximum": 365,
          "default": 7,
          "examples": [7, 14, 30, 90]
        },
        "ClockSkewMinutes": {
          "type": "integer",
          "description": "Clock skew tolerance in minutes for token validation",
          "minimum": 0,
          "maximum": 15,
          "default": 5,
          "examples": [0, 2, 5, 10]
        },
        "RequireHttpsMetadata": {
          "type": "boolean",
          "description": "Whether HTTPS is required for metadata retrieval",
          "default": true,
          "examples": [true, false]
        },
        "SaveToken": {
          "type": "boolean",
          "description": "Whether to save the token in the authentication properties",
          "default": true,
          "examples": [true, false]
        },
        "ValidateIssuer": {
          "type": "boolean",
          "description": "Whether to validate the token issuer",
          "default": true,
          "examples": [true, false]
        },
        "ValidateAudience": {
          "type": "boolean",
          "description": "Whether to validate the token audience",
          "default": true,
          "examples": [true, false]
        },
        "ValidateLifetime": {
          "type": "boolean",
          "description": "Whether to validate token lifetime",
          "default": true,
          "examples": [true, false]
        },
        "ValidateIssuerSigningKey": {
          "type": "boolean",
          "description": "Whether to validate the issuer signing key",
          "default": true,
          "examples": [true, false]
        }
      },
      "required": [
        "Secret",
        "Issuer",
        "Audience",
        "TokenExpirationMinutes",
        "RefreshTokenExpirationDays"
      ],
      "additionalProperties": false
    }
  },
  "additionalProperties": true,
  "examples": [
    {
      "Jwt": {
        "Secret": "YourSuperSecureRandomStringHere123!@#WithAtLeast32Characters",
        "Issuer": "B2X",
        "Audience": "B2X.API",
        "TokenExpirationMinutes": 60,
        "RefreshTokenExpirationDays": 7,
        "ClockSkewMinutes": 5,
        "RequireHttpsMetadata": true,
        "SaveToken": true,
        "ValidateIssuer": true,
        "ValidateAudience": true,
        "ValidateLifetime": true,
        "ValidateIssuerSigningKey": true
      }
    }
  ]
}