{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ai-dev-standards/schemas/orchestration-request.json",
  "title": "Orchestration Request",
  "description": "Schema for Claude Code orchestration requests created by Brain commands",
  "type": "object",
  "required": ["id", "type", "goal", "timestamp", "status"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique request ID (timestamp-based)",
      "pattern": "^\\d{13}$"
    },
    "type": {
      "type": "string",
      "description": "Type of orchestration request",
      "enum": [
        "plan",
        "validate",
        "diagnose",
        "generate_manifest",
        "build_capability_graph",
        "analyze_project"
      ]
    },
    "goal": {
      "type": "string",
      "description": "High-level user goal or task description",
      "minLength": 3,
      "maxLength": 1000
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp of request creation",
      "format": "date-time"
    },
    "status": {
      "type": "string",
      "description": "Current request status",
      "enum": ["pending", "in_progress", "completed", "failed"]
    },
    "context": {
      "type": "object",
      "description": "Additional context for the request",
      "properties": {
        "project_path": {
          "type": "string",
          "description": "Absolute path to project directory"
        },
        "skill_path": {
          "type": "string",
          "description": "Path to specific skill (for validation/manifest generation)"
        },
        "available_skills": {
          "type": "array",
          "description": "List of available skills from registry",
          "items": {
            "type": "string"
          }
        },
        "capability_graph_path": {
          "type": "string",
          "description": "Path to capability graph JSON"
        },
        "constraints": {
          "type": "object",
          "description": "Execution constraints",
          "properties": {
            "max_cost": {
              "type": "number",
              "description": "Maximum acceptable cost"
            },
            "max_duration": {
              "type": "number",
              "description": "Maximum duration in minutes"
            },
            "risk_tolerance": {
              "type": "string",
              "enum": ["low", "medium", "high"]
            }
          }
        },
        "preferences": {
          "type": "object",
          "description": "User preferences for plan generation",
          "properties": {
            "prefer_tested": {
              "type": "boolean",
              "description": "Prefer skills with high test coverage"
            },
            "prefer_documented": {
              "type": "boolean",
              "description": "Prefer skills with comprehensive docs"
            }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Request metadata",
      "properties": {
        "created_by": {
          "type": "string",
          "description": "Command that created this request"
        },
        "user": {
          "type": "string",
          "description": "User who initiated the request"
        },
        "priority": {
          "type": "string",
          "enum": ["low", "medium", "high", "urgent"]
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "result_path": {
      "type": "string",
      "description": "Path where result will be written (set when completed)"
    },
    "error": {
      "type": "object",
      "description": "Error information if request failed",
      "properties": {
        "message": {
          "type": "string"
        },
        "code": {
          "type": "string"
        },
        "details": {
          "type": "object"
        }
      }
    }
  }
}
